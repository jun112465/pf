# Mini Blog App (1인 프로젝트)

![스크린샷 2024-03-02 오후 9.21.37.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/356c644f-77fc-42b5-93bc-ba740279fd9a/83c2c728-3ec1-4f54-85ac-b2035aecee85/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-03-02_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_9.21.37.png)

## 프로젝트 설명
- **설명** : 마크업 언어를 통해 글을 작성하고 저장할 수 있는 웹앱이다. 노션과 같이 실시간으로 게시글을 마크업 언어로 편집하고 저장이 가능하다. 댓글 기능을 통해 다른 회원의 게시글에 댓글을 남길 수 있다.
- **개발동기** : 평소에 간단히 메모해야 할 내용들을 맥os의 note app을 이용했으나 모든 note를 한눈에 보기 어려웠고, 카테고리별로 보기에도 우측의 네비게이션을 사용하는게 귀찮았다. 지인의 권유로 Notion을 사용해보려 했으나 정말 간단한 노트만 작성하기에는 과한 느낌이 들었다. 그래서 한눈에 들어오고 작성이 편한 note app을 직접 만들기로 결정했다. 개발과정에서 다른 사람들의 노트도 볼 수 있는 간단한 블로그 앱으로 컨셉을 바꾸고, 관련 기능들을 추가했다.
- **기술스택 & 배포환경**
    - SpringBoot
    - Java 11
    - Thymeleaf
    - MariaDB
    - Jpa
    - ec2 (ubuntu)
- **구현 기능**
    - 회원 가입
    - 회원 로그인
    - 회원 로그아웃
    - 회원 탈퇴
    - 노트 추가, 삭제, 수정
    - 카테고리 생성, 삭제,수정을 통한 노트 분류
    - 노트에 대한 회원들의 댓글 기능
    - 일부 예외처리 기능 구현

## **프로젝트 구조**

- **서비스 구조**
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/356c644f-77fc-42b5-93bc-ba740279fd9a/f9ed1c74-ea5a-459e-afe9-0bde8eed0b2c/Untitled.png)
    
- **DB 구조**
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/356c644f-77fc-42b5-93bc-ba740279fd9a/83cdab3a-27b8-4337-8ec2-c0419833ac0b/Untitled.png)
    
- **대표 이미지**
    
    ![스크린샷 2024-03-02 오후 9.21.37.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/356c644f-77fc-42b5-93bc-ba740279fd9a/83c2c728-3ec1-4f54-85ac-b2035aecee85/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-03-02_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_9.21.37.png)
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/356c644f-77fc-42b5-93bc-ba740279fd9a/997709f3-b92f-45c6-ab94-d10883997083/Untitled.png)
    
    ![스크린샷 2024-03-02 오후 9.21.47.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/356c644f-77fc-42b5-93bc-ba740279fd9a/d709ba78-3d99-485d-96d3-a1c9e67dc00e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-03-02_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_9.21.47.png)
    
    ![스크린샷 2024-03-02 오후 9.22.44.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/356c644f-77fc-42b5-93bc-ba740279fd9a/f28061a2-6d69-40ff-9685-72b639b32c4a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-03-02_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_9.22.44.png)
    
- **간단한 시연영상**
    
    https://www.youtube.com/watch?v=6-7HTlVn5gs
    

---

## **어려움 및 성과**

- **겪은 어려움과 해결방법**
    - 초기에는 Jdbc를 이용해 개발을 했다. 새로운 테이블을 추가해 기능을 확장하기로 했다. 새로운 테이블과 다른 테이블간의 join 문을 작성과 테이블 Create이 귀찮아서 이를 단순화 시켜주는 JPA에 대하여 간단히 공부 후 적용.
    - 노트에 내용을 저장할 때, DB에서 값을 varchar(10000)을 통해 문자열을 저장했다. 하지만 많은 양의 텍스트 데이터를 저장할 필요가 있을 때 varchar의 최대 크기인 65,535바이트가 부족할 수 도 있다는 생각이 들었습니다. 일반적으로 웹에서 만날 수 있는 포스트에서 글자 수가 상당히 많았는데 이것을 어떻게 처리하는 것인지 검색을 해본 결과 대용량의 텍스트 데이터를 저장할 때는 varchar가 아닌 mediumText를 사용한다는 것을 알게됐다. 인덱싱 기능은 varchar보다 떨어지지만 테이블에 직접적으로 저장하는 것이 아니라 별도의 공간에 저장하기에 큰 용량을 저장할 수 있다는 것을 알게됐다.
    - 노트의 변경사항을 저장할 때 기존에는 keyboard input event가 일어날 때마다 노트의 전체내용을 POST로 보내서 DB 커넥션을 연결 후 UPDATE 쿼리를 날렸다. 지금은 나 혼자만 사용하는 웹앱이지만 동시에 많은 사용자가 있다면 이런 방식은 리소스를 엄청나게 낭비 해 서버 운영에 무리가 있을거라 판단했다. 이를 해결하기 위해 여러가지 방법을 검색했다. HTTP Polling, Web Socket 과 같은 기술들을 확인하고 구현 방법을 확인했다. Http Polling 방식은 기존 방식과 크게 다른게 없어 보였고, Web Socket 기술을 공부하고 사용하기에는 시간적으로 충분하지 않았다고 느꼈다. 다른 방법이 없을까 고민해본 끝에 클라이언트 단에서 키보드 입력 후 5초 후에 노트의 내용을 전송하면 리소스의 큰 낭비를 줄일 수 있다고 판단해 해당 기능을 setTimeout 함수를 통해 구현했다. 어려운 기술을 사용해서 문제를 해결하기 보다는 간단한 방식을 통해 문제를 해결하는 것이 더 중요하다는 생각이 들었다.
    - 개발 초기에는 노트에 카테고리가 없어서 모든 노트가 1자로 있었다. 후에 카테고리 테이블을 생성하면서 post 테이블에 category(varchar) 컬럼을 추가했었다. category 컬럼의 값은 변경 가능한 문자열이였고 컬럼명 변경 기능을 넣을 때 notice 테이블의 카테고리 컬럼과 notice category 테이블의 카테고리 컬럼이 일치하지 않아 DB의 특성 중 하나인 Data Integrity(데이터 무결성)가 위배되면서 join이 제대로 되지 않았다. 문제를 인지한 후 post 테이블의 컬럼값을 수정해 주었다. 이를 통해 데이터베이스 설계의 중요성을 깨닫게 되었고 다음부터는 미리미리 ERDiagram을 통해 이러한 문제를 사전에 예방하면 좋겠다는 생각을 했다.
    - 회원가입시 ID 중복 가입을 방지하기 위해서 RedirectAttributes/FlashMap 객체를 활용하여 에러메세지를 root controller에 전송하는 식으로 에러처리를 하였다. 지금과 같은 작은 프로젝트에서 에러를 처리하는데에 해당 방법을 사용해도 문제가 없었겠지만 에러를 처리할 부분이 많아지면 해당 방식으로 계속 root controller에 에러메세지를 보내고 처리하는 것은 비효율적이라 생각했다. 이러한 부분을 어떻게 더 효율적으로 처리하는지 분명 정답이 있을거라 생각해 구글에 “springboot 에러처리” 라는 검색어를 입력해 찾아봤다. 다른 사람들은 어떻게 처리하는지에 대해서 찾아보니 “@ExceptionHandler”를 사용해 모든 에러를 처리하는 controller를 만들어야 한다는 사실을 배웠다. 이러한 경험을 통해 여러 방식으로 구현하는 것이 공부에는 좋겠지만, 개발자로 일을 하게 된다면 항상 최선의 방식으로 빠르게 결과를 내야한다는 생각이 들었다. 그래서 혼자서 하는 것보다 팀을 이뤄 의견을 교환하고 나보다 더 잘하는 사람의 코드를 보고 배울 수 있는 환경에 들어가야겠다고 생각했다.
    - 스프링 세션을 사용해 로그인 구현을 했었다. 세션 로그인 기능은 보안 측면에서 취약하다는 것을 알게되고 Jwt를 사용해 로그인 기능을 구현하기로 했다. Jwt를 적용시키기 위해 스프링 시큐리티를 프로젝트에 사용했다. 토큰을 통한 인증을 모든 컨트롤러에 대해서 설정하는 것 보다 스프링시큐리티를 배워서 필터를 사용하는게 더 쉬워보였기 때문이다. 처음 사용해보는 것이었기에 어려움이 많았지만 차근차근 개념을 학습하고 성공적으로 적용시킬 수 있었다.
    - 연관관계 매핑된 두 Entity에 대해서 부모 Entity에 대한 삭제가 되지 않았다. Jpa 연관관계에 대한 개념 학습이 완료되지 않은 상태에서 편의를 위해 jpa를 사용했던 것이기에 해당 오류를 처음에 어떻게 해결해야 할 지 막막했다. 부모 엔터티에서 @OneToMany 가 적용된 리스트에 cascade 값을 적절하게 설정해주면 자동으로 삭제 시 자식 엔터티는 전부 삭제되게 설정할 수 있다는 것을 알게되어 해당 기능을 사용할 수 있었다.
    - 테스트코드에서 엔터티를 출력하고 있었다. 두 엔터티가 양방향 매핑이 되어있어서 엔터티를 출력할 때 순환참조를 하게되어 “Method threw 'java.lang.StackOverflowError' exception. Cannot evaluate 패키지.toString()” 에러가 발생했다. 양방향 매핑이 된 경우 “toString()” 메소드를 오버라이딩하여 해당 오류가 안 뜰 수 있다는 것을 배울 수 있었다.
